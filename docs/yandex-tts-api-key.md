# Как создать API-ключ Yandex Cloud для SpeechKit (озвучка)

Пошаговая инструкция для получения ключа, который подставляется в `.env` как `YANDEX_TTS_API_KEY`. Актуально для консоли [cloud.yandex.ru](https://cloud.yandex.ru).

---

## 0. Если у вас казахский (или другой) интерфейс и нет пункта «Каталоги»

В казахской версии консоли пункты меню могут называться иначе. Сделайте так:

**Вариант А — открыть страницу каталогов по прямой ссылке**

1. Откройте в браузере: **[console.cloud.yandex.ru/folders](https://console.cloud.yandex.ru/folders)**  
   Так вы попадёте на список каталогов (папок). Если каталогов ещё нет — нажмите кнопку создания (обычно «Создать каталог» / «Create folder» и т.п.).
2. После создания или выбора каталога откройте его (клик по названию). В адресной строке появится URL вида:
   `https://console.cloud.yandex.ru/folders/b1gxxxxxxxxxx`  
   Часть **`b1gxxxxxxxxxx`** — это **ID каталога** (Folder ID). Его нужно указать в `.env` как `YANDEX_FOLDER_ID`.

**Вариант Б — через «Создание ресурса»**

1. Если видите только **«Ресурс создание»** (или «Создать ресурс» / «Create resource») и там **выбор категории** — в этой форме обычно есть выбор **каталога** (папки) вверху или в настройках.
2. Выберите или создайте каталог там, затем откройте **[console.cloud.yandex.ru/folders](https://console.cloud.yandex.ru/folders)** — в списке будет ваш каталог. Клик по нему откроет страницу с ID в URL (как в варианте А).

**Вариант В — переключить язык на русский**

1. В консоли найдите переключатель языка (часто внизу страницы или в профиле/настройках).
2. Выберите **Русский**. Появится пункт **«Управление ресурсами»** → **«Каталоги»** в левом меню — дальше по шагу 2 ниже.

---

## 1. Войти в Yandex Cloud

1. Откройте **[cloud.yandex.ru](https://cloud.yandex.ru)**.
2. Войдите через аккаунт Яндекса (или зарегистрируйтесь).
3. Если просят — подтвердите номер телефона.

---

## 2. Создать или выбрать каталог (папку)

1. Откройте **[console.cloud.yandex.ru/folders](https://console.cloud.yandex.ru/folders)** (или в меню: **«Управление ресурсами»** → **«Каталоги»**).
2. Выберите нужный каталог или нажмите **«Создать каталог»**, введите имя и создайте его.
3. **Запомните ID каталога** — он в URL после открытия каталога:
   - URL вида: `https://console.cloud.yandex.ru/folders/b1gxxxxxxxxxx`
   - `b1gxxxxxxxxxx` — это **Folder ID**. Его нужно указать в `.env` как `YANDEX_FOLDER_ID`.

---

## 3. Включить SpeechKit и привязать платёжный аккаунт (если ещё не сделано)

1. В меню выберите **«Сервисы»** → **«SpeechKit»** (или найдите через поиск по консоли).
2. Если сервис ещё не подключён — нажмите **«Подключиться»** / **«Включить»**.
3. Для использования API нужен **платёжный аккаунт**. Если его нет:
   - Перейдите в **«Биллинг»** или по запросу консоли привяжите карту.
   - Новым пользователям часто дают **пробный период** (грант на 60 дней).

---

## 4. Создать сервисный аккаунт

1. **Сначала откройте нужный каталог** (шаг 2) — перейдите на [console.cloud.yandex.ru/folders](https://console.cloud.yandex.ru/folders) и кликните по каталогу.
2. В левом меню найдите **«Сервисные аккаунты»** (по-английски может быть **Service accounts**; в казахском интерфейсе — пункт про «сервистік тіркелгілер» или доступ/учётные записи).
3. Нажмите **«Создать сервисный аккаунт»** (или **Create service account**).
4. Укажите **имя** (например, `speechkit-tts`).
5. В блоке **«Роли»** нажмите **«Добавить роль»** и выберите одну из:
   - **`ai.speechkit-stt.user`** — доступ к SpeechKit (распознавание и синтез), или
   - **`editor`** — полный доступ к ресурсам каталога (если роли SpeechKit нет в списке).
6. Нажмите **«Создать»**.

---

## 5. Создать API-ключ для сервисного аккаунта

1. В списке сервисных аккаунтов **нажмите на имя** только что созданного аккаунта.
2. Откройте вкладку **«API-ключи»** (или **«Ключи доступа»** / **«Учётные данные»**).
3. Нажмите **«Создать API-ключ»** (или **«Создать ключ»**).
4. Введите **описание** (например, `TTS для Sөyle`).
5. Нажмите **«Создать»**.
6. **Сразу скопируйте значение ключа** — оно показывается **один раз**. После закрытия окна ключ нельзя посмотреть, только создать новый.

Этот ключ — это и есть **API-ключ** для заголовка `Authorization: Api-Key <ключ>`.

---

## 6. Прописать ключ и Folder ID в проекте

1. В корне проекта откройте файл **`.env`**.
2. Добавьте или обновите строки (подставьте свои значения):

```env
YANDEX_TTS_API_KEY=ваш_скопированный_ключ_без_пробелов
YANDEX_FOLDER_ID=ид_каталога_из_шага_2
```

Пример:

```env
YANDEX_TTS_API_KEY=AQVNxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
YANDEX_FOLDER_ID=b1gxxxxxxxxxx
```

3. Сохраните файл и **перезапустите** dev-сервер (`npm run dev`).

---

## Если ключ не подходит (401 Unauthorized)

- Убедитесь, что в `.env` нет лишних пробелов и кавычек вокруг ключа.
- Проверьте, что скопировали ключ целиком (обычно начинается с `AQVN...` или похожего).
- Если ключ был отозван или истёк — создайте **новый** API-ключ (шаги 5–6) и замените значение `YANDEX_TTS_API_KEY`.
- Убедитесь, что у сервисного аккаунта есть роль доступа к SpeechKit (шаг 4).

---

## Полезные ссылки

- Консоль Yandex Cloud: [cloud.yandex.ru](https://cloud.yandex.ru)
- Документация SpeechKit: [cloud.yandex.ru/docs/speechkit](https://cloud.yandex.ru/docs/speechkit)
- Управление API-ключами (IAM): в консоли → каталог → **Сервисные аккаунты** → нужный аккаунт → вкладка **API-ключи**
